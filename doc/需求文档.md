# 安全密钥管理系统概要需求文档

- [安全密钥管理系统概要需求文档](#%E5%AE%89%E5%85%A8%E5%AF%86%E9%92%A5%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%A6%81%E9%9C%80%E6%B1%82%E6%96%87%E6%A1%A3)
  - [1 目的](#1-%E7%9B%AE%E7%9A%84)
  - [2 参考资料](#2-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99)
  - [3 功能模块](#3-%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97)
    - [3.1 用户注册管理](#31-%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C%E7%AE%A1%E7%90%86)
    - [3.2 证书/证书撤销列表的生成与签发](#32-%E8%AF%81%E4%B9%A6%E8%AF%81%E4%B9%A6%E6%92%A4%E9%94%80%E5%88%97%E8%A1%A8%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AD%BE%E5%8F%91)
    - [3.3 证书撤销列表的存储与发布](#33-%E8%AF%81%E4%B9%A6%E6%92%A4%E9%94%80%E5%88%97%E8%A1%A8%E7%9A%84%E5%AD%98%E5%82%A8%E4%B8%8E%E5%8F%91%E5%B8%83)
    - [3.4 证书状态的查询](#34-%E8%AF%81%E4%B9%A6%E7%8A%B6%E6%80%81%E7%9A%84%E6%9F%A5%E8%AF%A2)
    - [3.5 密钥的生成与管理](#35-%E5%AF%86%E9%92%A5%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E7%AE%A1%E7%90%86)
    - [3.6 安全管理](#36-%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86)

## 1 目的

本系统基于 GB/T 28181，添加安全密钥管理服务，用于 GB35114。

- 设计简易证书认证系统用于对声明周期内的数字证书进行全过程管理
- 主要功能包括：用户注册管理、证书/证书撤销列表的生成与签发、证书撤销列表的存储与发布、证书状态的查询、密钥的生成与管理

## 2 参考资料

- GBT 28181-2016 公共安全视频监控联网系统信息传输、交换、控制技术要求
- GB 35114-2017 公共安全视频监控联网信息安全技术要求
- GMT 0034-2014 基于SM2密码算法的证书认证系统密码及其相关安全技术规范
- RFC 6960 OCSP 协议

## 3 功能模块

### 3.1 用户注册管理

- 负责用户的证书申请、身份审核和证书下载，目前需要完成远程注册管理系统，不考虑本地注册管理系统
- 功能包括
  - 证书申请：登录到用户注册管理系统申请证书
  - 身份审核：深刻人员通过用户注册管理系统，对证书申请者进行身份审核
  - 证书下载：登录到用户注册管理系统下载证书

### 3.2 证书/证书撤销列表的生成与签发

- 证书类型
  - 按主体对象分：人员证书、设备证书、机构证书
  - 按功能分：加密证书、签名证书
- 负责生成、签发数字证书和证书撤销列表
  - 证书生成/签发：用户的数字证书由系统的 CA 签发（暂时只需要一个 CA，即自签发 CA）
  - 证书撤销列表：只考虑用户证书撤销列表(CRL)
- 证书机制：采用双证书机制，每个用户拥有两张数字证书，分别用于数字签名和数据加密
  - 用于数字签名的密钥对可由用户利用具有密码运算功能的证书载体产生
  - 用于数据加密的密钥对由 KMC 产生并负责安全管理
  - 签名证书和加密证书一起保存在用户的证书载体

### 3.3 证书撤销列表的存储与发布

- 负责数字证书、证书撤销列表的存储和发布
- 功能包括
  - 采用数据库或目录服务方式
  - 数字证书/证书撤销列表的存储、备份和恢复
  - 提供查询功能

### 3.4 证书状态的查询

- 为用户和应用系统提供证书状态查询服务，包括
  - CRL 查询：用户或应用系统利用数字证书中标识的 CRL 地址，下载 CRL，并检验证书有效性
  - 在线证书状态查询：用户或应用系统利用 OCSP 协议，实时查询证书状态
  - 上述两种方式至少实现一种

### 3.5 密钥的生成与管理

- 功能包括密钥生成、密钥存储、密钥分发、密钥备份、密钥更新、密钥撤销、密钥归档、密钥恢复

| 功能 | 描述 | 补充 |
| --- | --- | --- |
| 密钥生成 | 根据 CA 请求为用户生成非对称密钥对 | 密钥对由硬件密码设备生成 |
| 密钥存储 | 生成的非对称密钥对，经硬件密码设备加密后存储在数据库 | - |
| 密钥分发 | 生成的非对称密钥对，经证书认证系统分发到用户证书载体 | - |
| 密钥备份 | 采用热备份、冷备份和异地备份等措施实现 | - |
| 密钥更新 | 根据 CA 请求为用户生成新的非对称密钥对 | 证书到期或用户需要 |
| 密钥撤销 | 撤销用户当前使用的密钥 | 证书到期、用户需要或管理机构依据合同规定 |
| 密钥归档 | 为到期或撤销的密钥提供安全长期的存储 | - |
| 密钥恢复 | 恢复特定密钥 | 为用户或司法取证用，一般用户只可恢复自身密钥 |

### 3.6 安全管理

- 安全管理系统包括
  - 安全审计系统：提供事件级审计功能，对设计系统安全的行为、人员、时间等记录进行跟踪、统计和分析
  - 安全防护系统：提供访问控制、入侵检测(入侵防御)、漏洞扫描、病毒防治等网络安全功能